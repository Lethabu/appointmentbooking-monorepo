(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7130],{9414:function(e,s,t){Promise.resolve().then(t.bind(t,6542))},6542:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return p}});var n=t(2303),a=t(4757),r=t(2307),i=t(3004),c=t(1359);let l=(0,c.Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var d=t(8465);let o=(0,c.Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),u=(0,c.Z)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);var x=t(9203),h=t(2133),f=t(3869),m=t(497),v=t(9634),j=t(2937),y=t(9391),g=t(4475);function p(){let[e,s]=(0,f.useState)(null),[t,c]=(0,f.useState)(!0),[p,N]=(0,f.useState)(null),[b,w]=(0,f.useState)(!1),k="default";(0,f.useEffect)(()=>{S()},[]);let S=async()=>{try{c(!0);let e=await fetch("/api/calendar/sync-status",{headers:{tenantId:k}});if(!e.ok)throw Error("Failed to fetch sync status");let t=await e.json();s(t.data),N(null)}catch(e){N(e instanceof Error?e.message:"Failed to fetch sync status")}finally{c(!1)}},C=async()=>{try{w(!0);let e=await fetch("/api/calendar/sync-status/retry",{method:"POST",headers:{"Content-Type":"application/json",tenantId:k},body:JSON.stringify({maxRetries:10})});if(!e.ok)throw Error("Failed to retry failed syncs");let s=await e.json();await S(),alert("Retry completed: ".concat(s.data.successful," successful, ").concat(s.data.failed," failed"))}catch(e){alert("Failed to retry syncs: ".concat(e instanceof Error?e.message:"Unknown error"))}finally{w(!1)}},E=async e=>{if(confirm("Are you sure you want to disconnect this calendar integration?"))try{if(!(await fetch("/api/google-calendar/disconnect",{method:"POST",headers:{tenantId:k}})).ok)throw Error("Failed to disconnect calendar");await S()}catch(e){alert("Failed to disconnect calendar: ".concat(e instanceof Error?e.message:"Unknown error"))}},Z=e=>(0,n.jsx)(v.C,{variant:{created:"default",updated:"default",failed:"destructive",deleted:"secondary"}[e]||"outline",children:e});return t?(0,n.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,n.jsx)(l,{className:"h-8 w-8 animate-spin"})}):(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-3xl font-bold",children:"Calendar Integration"}),(0,n.jsx)("p",{className:"text-muted-foreground",children:"Manage calendar integrations and monitor synchronization"})]}),(0,n.jsxs)(j.z,{onClick:S,variant:"outline",children:[(0,n.jsx)(l,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),p&&(0,n.jsxs)(m.bZ,{variant:"destructive",children:[(0,n.jsx)(r.Z,{className:"h-4 w-4"}),(0,n.jsx)(m.X,{children:p})]}),e&&(0,n.jsxs)(y.Zb,{children:[(0,n.jsxs)(y.Ol,{children:[(0,n.jsxs)(y.ll,{className:"flex items-center gap-2",children:[(e=>{switch(e){case"healthy":return(0,n.jsx)(a.Z,{className:"h-4 w-4 text-green-500"});case"warning":return(0,n.jsx)(r.Z,{className:"h-4 w-4 text-yellow-500"});case"critical":return(0,n.jsx)(i.Z,{className:"h-4 w-4 text-red-500"});default:return(0,n.jsx)(r.Z,{className:"h-4 w-4 text-gray-500"})}})(e.health.overall),"System Health"]}),(0,n.jsx)(y.SZ,{children:"Overall status of calendar integrations and sync operations"})]}),(0,n.jsxs)(y.aY,{children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsxs)("div",{className:"text-2xl font-bold",children:[e.statistics.successRate,"%"]}),(0,n.jsx)("div",{className:"text-sm text-muted-foreground",children:"Success Rate"})]}),(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"text-2xl font-bold",children:e.statistics.totalSyncs}),(0,n.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total Syncs"})]}),(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"text-2xl font-bold",children:e.statistics.failedSyncs}),(0,n.jsx)("div",{className:"text-sm text-muted-foreground",children:"Failed Syncs"})]})]}),e.health.issues.length>0&&(0,n.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,n.jsx)("h4",{className:"font-semibold",children:"Issues:"}),e.health.issues.map((e,s)=>(0,n.jsxs)(m.bZ,{children:[(0,n.jsx)(r.Z,{className:"h-4 w-4"}),(0,n.jsx)(m.X,{children:e})]},s))]}),e.health.recommendations.length>0&&(0,n.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,n.jsx)("h4",{className:"font-semibold",children:"Recommendations:"}),(0,n.jsx)("ul",{className:"list-disc list-inside space-y-1",children:e.health.recommendations.map((e,s)=>(0,n.jsx)("li",{className:"text-sm text-muted-foreground",children:e},s))})]})]})]}),(0,n.jsxs)(g.mQ,{defaultValue:"connections",className:"space-y-4",children:[(0,n.jsxs)(g.dr,{children:[(0,n.jsx)(g.SP,{value:"connections",children:"Connections"}),(0,n.jsx)(g.SP,{value:"sync-events",children:"Recent Sync Events"}),(0,n.jsx)(g.SP,{value:"settings",children:"Settings"})]}),(0,n.jsxs)(g.nU,{value:"connections",className:"space-y-4",children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsxs)(y.Zb,{children:[(0,n.jsxs)(y.Ol,{children:[(0,n.jsxs)(y.ll,{className:"flex items-center gap-2",children:[(0,n.jsx)(d.Z,{className:"h-5 w-5"}),"Google Calendar"]}),(0,n.jsx)(y.SZ,{children:"Sync appointments with Google Calendar"})]}),(0,n.jsx)(y.aY,{children:(null==e?void 0:e.connections.find(e=>"google"===e.provider))?(0,n.jsx)("div",{className:"space-y-4",children:(()=>{let s=e.connections.find(e=>"google"===e.provider);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)(v.C,{variant:s.isActive?"default":"secondary",children:s.isActive?"Connected":"Disconnected"}),s.isActive&&(0,n.jsx)(j.z,{variant:"outline",size:"sm",onClick:()=>E(s.id),children:(0,n.jsx)(o,{className:"h-4 w-4"})})]}),(0,n.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{children:"Success:"}),(0,n.jsx)("span",{className:"text-green-600",children:s.successCount})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{children:"Errors:"}),(0,n.jsx)("span",{className:"text-red-600",children:s.errorCount})]}),s.lastSync&&(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{children:"Last Sync:"}),(0,n.jsx)("span",{children:new Date(s.lastSync).toLocaleString()})]}),s.lastError&&(0,n.jsxs)("div",{className:"text-red-600 text-xs",children:["Last Error: ",s.lastError]})]})]})})()}):(0,n.jsxs)(j.z,{onClick:()=>{window.location.href="/api/google-calendar/oauth?tenantId=".concat(k)},className:"w-full",children:[(0,n.jsx)(u,{className:"h-4 w-4 mr-2"}),"Connect Google Calendar"]})})]}),(0,n.jsxs)(y.Zb,{children:[(0,n.jsxs)(y.Ol,{children:[(0,n.jsxs)(y.ll,{className:"flex items-center gap-2",children:[(0,n.jsx)(x.Z,{className:"h-5 w-5"}),"Outlook Calendar"]}),(0,n.jsx)(y.SZ,{children:"Sync appointments with Microsoft Outlook"})]}),(0,n.jsx)(y.aY,{children:(null==e?void 0:e.connections.find(e=>"microsoft"===e.provider))?(0,n.jsx)("div",{className:"space-y-4",children:(()=>{let s=e.connections.find(e=>"microsoft"===e.provider);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)(v.C,{variant:s.isActive?"default":"secondary",children:s.isActive?"Connected":"Disconnected"}),s.isActive&&(0,n.jsx)(j.z,{variant:"outline",size:"sm",onClick:()=>E(s.id),children:(0,n.jsx)(o,{className:"h-4 w-4"})})]}),(0,n.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{children:"Success:"}),(0,n.jsx)("span",{className:"text-green-600",children:s.successCount})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{children:"Errors:"}),(0,n.jsx)("span",{className:"text-red-600",children:s.errorCount})]}),s.lastSync&&(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{children:"Last Sync:"}),(0,n.jsx)("span",{children:new Date(s.lastSync).toLocaleString()})]}),s.lastError&&(0,n.jsxs)("div",{className:"text-red-600 text-xs",children:["Last Error: ",s.lastError]})]})]})})()}):(0,n.jsxs)(j.z,{onClick:()=>{window.location.href="/api/outlook-calendar/oauth?tenantId=".concat(k)},className:"w-full",children:[(0,n.jsx)(u,{className:"h-4 w-4 mr-2"}),"Connect Outlook Calendar"]})})]})]}),e&&e.statistics.failedSyncs>0&&(0,n.jsxs)(y.Zb,{children:[(0,n.jsxs)(y.Ol,{children:[(0,n.jsx)(y.ll,{children:"Sync Recovery"}),(0,n.jsx)(y.SZ,{children:"Retry failed synchronization operations"})]}),(0,n.jsx)(y.aY,{children:(0,n.jsx)(j.z,{onClick:C,disabled:b,variant:"outline",className:"w-full",children:b?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l,{className:"h-4 w-4 mr-2 animate-spin"}),"Retrying..."]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l,{className:"h-4 w-4 mr-2"}),"Retry ",e.statistics.failedSyncs," Failed Syncs"]})})})]})]}),(0,n.jsx)(g.nU,{value:"sync-events",className:"space-y-4",children:(0,n.jsxs)(y.Zb,{children:[(0,n.jsxs)(y.Ol,{children:[(0,n.jsx)(y.ll,{children:"Recent Sync Events"}),(0,n.jsx)(y.SZ,{children:"Latest calendar synchronization events"})]}),(0,n.jsx)(y.aY,{children:(null==e?void 0:e.recentEvents.length)===0?(0,n.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"No sync events found"}):(0,n.jsx)("div",{className:"space-y-4",children:null==e?void 0:e.recentEvents.map(e=>(0,n.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsxs)("div",{className:"font-medium",children:["Booking ",e.bookingId]}),(0,n.jsx)("div",{className:"text-sm text-muted-foreground",children:new Date(e.createdAt).toLocaleString()}),e.errorMessage&&(0,n.jsxs)("div",{className:"text-sm text-red-600",children:["Error: ",e.errorMessage]})]}),(0,n.jsx)("div",{className:"flex items-center gap-2",children:Z(e.syncStatus)})]},e.id))})})]})}),(0,n.jsx)(g.nU,{value:"settings",className:"space-y-4",children:(0,n.jsxs)(y.Zb,{children:[(0,n.jsxs)(y.Ol,{children:[(0,n.jsxs)(y.ll,{className:"flex items-center gap-2",children:[(0,n.jsx)(h.Z,{className:"h-5 w-5"}),"Sync Settings"]}),(0,n.jsx)(y.SZ,{children:"Configure calendar synchronization preferences"})]}),(0,n.jsx)(y.aY,{className:"space-y-4",children:(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"font-medium",children:"Auto-sync new appointments"}),(0,n.jsx)("div",{className:"text-sm text-muted-foreground",children:"Automatically create calendar events when appointments are booked"})]}),(0,n.jsx)(v.C,{variant:"outline",children:"Enabled"})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"font-medium",children:"Sync external calendar conflicts"}),(0,n.jsx)("div",{className:"text-sm text-muted-foreground",children:"Check external calendars for conflicts when booking"})]}),(0,n.jsx)(v.C,{variant:"outline",children:"Enabled"})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"font-medium",children:"Real-time webhook notifications"}),(0,n.jsx)("div",{className:"text-sm text-muted-foreground",children:"Receive instant updates when external calendar events change"})]}),(0,n.jsx)(v.C,{variant:"outline",children:"Enabled"})]})]})})]})})]})]})}},497:function(e,s,t){"use strict";t.d(s,{X:function(){return d},bZ:function(){return l}});var n=t(2303),a=t(8485),r=t(3869),i=t(5929);let c=(0,a.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive",warning:"border-yellow-500/50 text-yellow-600 bg-yellow-50 [&>svg]:text-yellow-600",success:"border-green-500/50 text-green-600 bg-green-50 [&>svg]:text-green-600",info:"border-blue-500/50 text-blue-600 bg-blue-50 [&>svg]:text-blue-600"}},defaultVariants:{variant:"default"}}),l=r.forwardRef((e,s)=>{let{className:t,variant:a,...r}=e;return(0,n.jsx)("div",{ref:s,role:"alert",className:(0,i.cn)(c({variant:a}),t),...r})});l.displayName="Alert",r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)("h5",{ref:s,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",t),...a})}).displayName="AlertTitle";let d=r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:s,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",t),...a})});d.displayName="AlertDescription"},9634:function(e,s,t){"use strict";t.d(s,{C:function(){return a}});var n=t(2303);let a=t(3869).forwardRef((e,s)=>{let{className:t,variant:a="default",...r}=e;return(0,n.jsx)("div",{ref:s,className:"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 ".concat({default:"bg-primary text-primary-foreground",secondary:"bg-secondary text-secondary-foreground",destructive:"bg-destructive text-destructive-foreground",outline:"border border-input"}[a]," ").concat(t||""),...r})});a.displayName="Badge"},2937:function(e,s,t){"use strict";t.d(s,{z:function(){return a}});var n=t(2303);let a=t(3869).forwardRef((e,s)=>{let{className:t,variant:a="default",size:r="default",...i}=e;return(0,n.jsx)("button",{className:"".concat("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background"," ").concat({default:"bg-crimson-DEFAULT text-white hover:bg-crimson-dark",destructive:"bg-crimson-dark text-white hover:bg-crimson-DEFAULT",outline:"border border-crimson-DEFAULT text-crimson-DEFAULT hover:bg-crimson-DEFAULT hover:text-white",secondary:"bg-neutral-100 text-neutral-800 hover:bg-neutral-200",ghost:"hover:bg-crimson-50 hover:text-crimson-DEFAULT",link:"underline-offset-4 hover:underline text-crimson-DEFAULT"}[a]," ").concat({default:"h-10 py-2 px-4",sm:"h-9 px-3 rounded-md",lg:"h-11 px-8 rounded-md",icon:"h-10 w-10"}[r]," ").concat(t||""),ref:s,...i})});a.displayName="Button"},9391:function(e,s,t){"use strict";t.d(s,{Ol:function(){return i},SZ:function(){return l},Zb:function(){return r},aY:function(){return d},ll:function(){return c}});var n=t(2303),a=t(3869);let r=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:s,className:"rounded-lg border bg-card text-card-foreground shadow-sm ".concat(t||""),...a})});r.displayName="Card";let i=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:s,className:"flex flex-col space-y-1.5 p-6 ".concat(t||""),...a})});i.displayName="CardHeader";let c=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)("h3",{ref:s,className:"text-2xl font-semibold leading-none tracking-tight ".concat(t||""),...a})});c.displayName="CardTitle";let l=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)("p",{ref:s,className:"text-sm text-muted-foreground ".concat(t||""),...a})});l.displayName="CardDescription";let d=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:s,className:"p-6 pt-0 ".concat(t||""),...a})});d.displayName="CardContent",a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:s,className:"flex items-center p-6 pt-0 ".concat(t||""),...a})}).displayName="CardFooter"},4475:function(e,s,t){"use strict";t.d(s,{SP:function(){return c},dr:function(){return i},mQ:function(){return r},nU:function(){return l}});var n=t(2303),a=t(3869);let r=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:s,className:t,...a})});r.displayName="Tabs";let i=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:s,className:"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground ".concat(t||""),...a})});i.displayName="TabsList";let c=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)("button",{ref:s,className:"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm ".concat(t||""),...a})});c.displayName="TabsTrigger";let l=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:s,className:"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 ".concat(t||""),...a})});l.displayName="TabsContent"},5929:function(e,s,t){"use strict";t.d(s,{cn:function(){return r}});var n=t(4100),a=t(9198);function r(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,a.m6)((0,n.W)(s))}},9203:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(1359).Z)("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]])},8465:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(1359).Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])}},function(e){e.O(0,[9451,158,2258,1744],function(){return e(e.s=9414)}),_N_E=e.O()}]);