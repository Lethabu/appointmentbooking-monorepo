# Strategic Space Creation Plan (Refined)

## Guiding Principles
- **Safety First:** Operations that modify Git history or delete files are dangerous. Always back up the repository before starting.
- **Effectiveness:** Focus on the largest and most common sources of bloat in a Node.js monorepo.
- **Maintainability:** The goal is not just a one-time cleanup, but to establish better practices for the future.

---

## Pre-Cleanup: Backup and Analysis

1.  **[CRITICAL] Backup the entire repository.**
2.  **Analyze Disk Usage:**
    - `git count-objects -vH` (for Git database size)
    - `du -sh .` (or equivalent for total directory size)
    - `du -sh apps/*/node_modules packages/*/node_modules` (to see `node_modules` size)

---

## Phase 1: Local Artifacts and Caches

- **Goal:** Remove temporary files generated by tools and builds. This is generally safe.

1.  **Clean `node_modules`:**
    - Remove all `node_modules` folders. A command like `find . -name "node_modules" -type d -prune -exec rm -rf '{}' +` can be used, but since I cannot execute it, I will list them for the user.
2.  **Clean Turborepo Cache:**
    - Delete the `.turbo/cache` directory.
3.  **Remove Build Logs and Temporary Files:**
    - Delete all `*.txt` and `*.log` files from the root directory.
    - Delete temporary JSON data files (`instyle-*.json`).
4.  **Reinstall Dependencies:**
    - Run `pnpm install`.

---

## Phase 2: Git Repository History (Advanced & Destructive)

- **Goal:** Remove large files and bloat from the Git history itself.
- **WARNING:** This phase rewrites Git history. All collaborators will need to fetch and re-base their work.

1.  **Identify Large Files in History:**
    - Use a script or tool to scan the Git history for large files.
2.  **Remove Large Files from History:**
    - Use a tool like `git filter-repo` (recommended) or BFG Repo-Cleaner.
    - Example: `git filter-repo --strip-blobs-bigger-than 10M`
3.  **Run Git Garbage Collection:**
    - `git gc --aggressive --prune=now`
4.  **Force-push to Remote:**
    - `git push --force` (coordinate with your team).

---

## Phase 3: Code and Dependency Hygiene

- **Goal:** Clean up the codebase itself.

1.  **Find and Remove Unused Dependencies:**
    - Manually inspect `package.json` files in each workspace.
    - Consider using a tool like `knip` in the future.
2.  **Find and Remove Unused Files:**
    - `git clean -fdx --dry-run`: This will show you which untracked files and directories will be removed.
    - `git clean -fdx`: **DANGEROUS**. This will permanently delete all untracked files and directories.
3.  **Organize and Consolidate Documentation:**
    - Review all `.md` files.
    - Consolidate duplicates (`GO_LIVE_GUIDE.md`, `DEPLOYMENT_GUIDE.md`, etc.).
    - Archive or remove outdated reports.

---

## Post-Cleanup

1.  **Verify System Functionality:**
    - Run `pnpm run build`, `pnpm run test`, etc. to ensure the project still works.
2.  **Report Space Savings:**
    - Re-run the analysis commands from the pre-cleanup step.